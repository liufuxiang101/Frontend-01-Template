<style>
  .keywords {
    color: blue;
  }

  .punctoutor {
    color: blueviolet;
  }

  .identifier {
    color: skyblue;
  }
</style>

<pre id="container"></pre>

<script>
  var source = `
    function sleep(t) {
      return new Promise(function(resolve) {
        setTimeout(resolve, t);
      });
    }
  `;

  var regexp = /(function|new|return)|([ \t\n\r]+)|([a-zA-Z][a-zA-Z0-9]*)|([\(\)\{\}\,\;])/g;

  var dictionary = ["keywords", "whitespace", "identifier", "punctuator"];

  var token = null;
  var lastIndex = 0;

  var container = document.getElementById("container");

  do {
    lastIndex = regexp.lastIndex;
    token = regexp.exec(source);

    console.log(regexp.lastIndex);

    if (!token) {
      break;
    }

    let text = document.createElement("span");
    text.textContent = token[0];

    for (let i = 0; i < 5; i++) {
      if (token[i]) {
        console.log(dictionary[i - 1]);

        //  处理 undefined
        if (dictionary[i - 1]) {
          text.classList.add(dictionary[i - 1]);
        }
      }
    }

    container.appendChild(text);
  } while (token);
</script>
